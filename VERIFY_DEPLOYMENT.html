<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify Phase 2 Deployment - Estalara</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-8 mb-6">
            <h1 class="text-3xl font-bold mb-2">üîç Phase 2 Deployment Verification</h1>
            <p class="text-gray-600 mb-6">This page helps you verify that Phase 2 changes are deployed and working correctly.</p>
            
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                <p class="text-sm">
                    <strong>‚úÖ Phase 2 IS deployed!</strong> The code is live at <code>https://pnawrocki9.github.io/estalara/</code>
                </p>
            </div>
        </div>

        <!-- Test Results -->
        <div class="bg-white rounded-lg shadow-lg p-8 mb-6">
            <h2 class="text-2xl font-bold mb-4">üìä Live Deployment Tests</h2>
            <div id="test-results" class="space-y-4">
                <p class="text-gray-500">Running tests...</p>
            </div>
        </div>

        <!-- localStorage Inspector -->
        <div class="bg-white rounded-lg shadow-lg p-8 mb-6">
            <h2 class="text-2xl font-bold mb-4">üíæ LocalStorage Data</h2>
            <div class="mb-4">
                <p class="text-sm text-gray-600 mb-2">Current CMS data stored in your browser:</p>
                <pre id="localStorage-data" class="bg-gray-100 p-4 rounded text-xs overflow-x-auto">No data found</pre>
            </div>
            <button onclick="initializeDefaultData()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                Initialize Default CMS Data
            </button>
            <button onclick="clearData()" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 ml-2">
                Clear All Data
            </button>
        </div>

        <!-- What to Check -->
        <div class="bg-white rounded-lg shadow-lg p-8">
            <h2 class="text-2xl font-bold mb-4">‚úÖ What Changed in Phase 2</h2>
            
            <div class="space-y-6">
                <div class="border-l-4 border-green-500 pl-4">
                    <h3 class="font-bold text-lg mb-2">1. Frontend Pages Now Load from CMS</h3>
                    <p class="text-sm text-gray-600 mb-2">Pages like index.html, agents.html now dynamically load:</p>
                    <ul class="list-disc list-inside text-sm text-gray-700 ml-4">
                        <li>Navigation menu items (desktop & mobile)</li>
                        <li>Footer links and social media</li>
                        <li>Feature cards on each page</li>
                        <li>Button text and URLs</li>
                    </ul>
                </div>

                <div class="border-l-4 border-blue-500 pl-4">
                    <h3 class="font-bold text-lg mb-2">2. How to See Changes</h3>
                    <ol class="list-decimal list-inside text-sm text-gray-700 ml-4 space-y-1">
                        <li>Open the <a href="https://pnawrocki9.github.io/estalara/admin" class="text-blue-600 underline" target="_blank">Admin Panel</a></li>
                        <li>Edit navigation, footer, or features</li>
                        <li>Click "Save"</li>
                        <li>Open <a href="https://pnawrocki9.github.io/estalara/" class="text-blue-600 underline" target="_blank">index.html</a> in a new tab</li>
                        <li>You should see your changes!</li>
                    </ol>
                </div>

                <div class="border-l-4 border-yellow-500 pl-4">
                    <h3 class="font-bold text-lg mb-2">3. Visual Changes</h3>
                    <p class="text-sm text-gray-600 mb-2">The admin panel UI looks mostly the same, but now controls:</p>
                    <ul class="list-disc list-inside text-sm text-gray-700 ml-4">
                        <li><strong>Navigation:</strong> All menu items across all pages</li>
                        <li><strong>Footer:</strong> Company info, links, social media</li>
                        <li><strong>Features:</strong> Feature cards for each page (Home, Agents, etc.)</li>
                        <li><strong>Buttons:</strong> CTA button text and URLs per page</li>
                    </ul>
                </div>

                <div class="border-l-4 border-purple-500 pl-4">
                    <h3 class="font-bold text-lg mb-2">4. Test It Now</h3>
                    <div class="space-y-2">
                        <a href="https://pnawrocki9.github.io/estalara/admin" 
                           target="_blank"
                           class="block bg-black text-white px-4 py-2 rounded text-center hover:bg-gray-800">
                            ‚Üí Open Admin Panel
                        </a>
                        <a href="https://pnawrocki9.github.io/estalara/" 
                           target="_blank"
                           class="block bg-blue-600 text-white px-4 py-2 rounded text-center hover:bg-blue-700">
                            ‚Üí View Frontend (index.html)
                        </a>
                        <a href="https://pnawrocki9.github.io/estalara/agents.html" 
                           target="_blank"
                           class="block bg-purple-600 text-white px-4 py-2 rounded text-center hover:bg-purple-700">
                            ‚Üí View Agents Page
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Technical Details -->
        <div class="bg-gray-900 text-white rounded-lg shadow-lg p-8 mt-6">
            <h2 class="text-2xl font-bold mb-4">üîß Technical Verification</h2>
            <div class="space-y-2 text-sm font-mono">
                <div class="flex justify-between">
                    <span>GitHub Pages URL:</span>
                    <span class="text-green-400">https://pnawrocki9.github.io/estalara/</span>
                </div>
                <div class="flex justify-between">
                    <span>Last Deployed:</span>
                    <span class="text-green-400">2025-10-13 16:16:21 GMT</span>
                </div>
                <div class="flex justify-between">
                    <span>Latest Commit on main:</span>
                    <span class="text-green-400">6171767 (Phase 2 complete)</span>
                </div>
                <div class="flex justify-between">
                    <span>cms-integration.js:</span>
                    <span id="cms-integration-status" class="text-yellow-400">Checking...</span>
                </div>
                <div class="flex justify-between">
                    <span>Phase 2 Features:</span>
                    <span id="phase2-status" class="text-yellow-400">Checking...</span>
                </div>
            </div>
        </div>
    </div>

    <script src="cms-integration.js"></script>
    <script>
        // Run verification tests
        async function runTests() {
            const results = [];
            
            // Test 1: Check if cms-integration.js is loaded
            const test1 = {
                name: "cms-integration.js loaded",
                status: typeof window.estalaraAdmin !== 'undefined',
                icon: typeof window.estalaraAdmin !== 'undefined' ? '‚úÖ' : '‚ùå'
            };
            results.push(test1);
            
            // Test 2: Check if Phase 2 methods exist
            const test2 = {
                name: "Phase 2 methods exist (loadFrontendElements, loadNavigation, loadFooter, loadFeatureCards)",
                status: window.estalaraAdmin && 
                        typeof window.estalaraAdmin.loadFrontendElements === 'function' &&
                        typeof window.estalaraAdmin.loadNavigation === 'function' &&
                        typeof window.estalaraAdmin.loadFooter === 'function' &&
                        typeof window.estalaraAdmin.loadFeatureCards === 'function',
                icon: window.estalaraAdmin && 
                      typeof window.estalaraAdmin.loadFrontendElements === 'function' ? '‚úÖ' : '‚ùå'
            };
            results.push(test2);
            
            // Test 3: Check localStorage
            const adminData = localStorage.getItem('estalaraAdminData');
            const test3 = {
                name: "localStorage has CMS data",
                status: adminData !== null,
                icon: adminData !== null ? '‚úÖ' : '‚ö†Ô∏è',
                details: adminData ? 'Data found' : 'No data - will use defaults'
            };
            results.push(test3);
            
            // Test 4: Check default data structure
            const test4 = {
                name: "Default data structure exists",
                status: window.estalaraAdmin && window.estalaraAdmin.content !== null,
                icon: window.estalaraAdmin && window.estalaraAdmin.content ? '‚úÖ' : '‚ùå'
            };
            results.push(test4);
            
            // Display results
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = results.map(test => `
                <div class="flex items-start gap-3 p-3 rounded ${test.icon === '‚úÖ' ? 'bg-green-50' : test.icon === '‚ö†Ô∏è' ? 'bg-yellow-50' : 'bg-red-50'}">
                    <span class="text-2xl">${test.icon}</span>
                    <div class="flex-1">
                        <div class="font-semibold">${test.name}</div>
                        ${test.details ? `<div class="text-sm text-gray-600">${test.details}</div>` : ''}
                    </div>
                </div>
            `).join('');
            
            // Update status indicators
            document.getElementById('cms-integration-status').textContent = test1.status ? '‚úÖ Loaded' : '‚ùå Not Found';
            document.getElementById('cms-integration-status').className = test1.status ? 'text-green-400' : 'text-red-400';
            
            document.getElementById('phase2-status').textContent = test2.status ? '‚úÖ All methods present' : '‚ùå Missing';
            document.getElementById('phase2-status').className = test2.status ? 'text-green-400' : 'text-red-400';
            
            // Display localStorage data
            displayLocalStorageData();
        }
        
        function displayLocalStorageData() {
            const data = localStorage.getItem('estalaraAdminData');
            const dataDiv = document.getElementById('localStorage-data');
            
            if (data) {
                try {
                    const parsed = JSON.parse(data);
                    dataDiv.textContent = JSON.stringify(parsed, null, 2);
                } catch (e) {
                    dataDiv.textContent = 'Error parsing data: ' + e.message;
                }
            } else {
                dataDiv.textContent = 'No CMS data found in localStorage.\n\nThis means the frontend will use default values from cms-integration.js.\n\nClick "Initialize Default CMS Data" below to populate with default content.';
            }
        }
        
        function initializeDefaultData() {
            if (!window.estalaraAdmin) {
                alert('EstalaraAdmin not loaded yet. Please refresh the page.');
                return;
            }
            
            // Force save current content to localStorage
            window.estalaraAdmin.saveContent();
            alert('‚úÖ Default CMS data has been initialized!\n\nNow open index.html or any other page to see the CMS-controlled content.');
            displayLocalStorageData();
            runTests();
        }
        
        function clearData() {
            if (confirm('Are you sure you want to clear all CMS data? This will reset everything to defaults.')) {
                localStorage.removeItem('estalaraAdminData');
                alert('‚úÖ All CMS data cleared. Page will reload with defaults.');
                location.reload();
            }
        }
        
        // Run tests when page loads
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(runTests, 500);
        });
    </script>
</body>
</html>
