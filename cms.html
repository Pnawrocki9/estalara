<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estalara CMS - Content Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK (Compat version for easier integration) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>
    <script src="firebase-auth.js"></script>
    <script src="firebase-db.js"></script>
    <script src="cms-firebase-adapter.js"></script>
    
    <!-- Load main.js first for reveal animations and utilities -->
    <script src="main.js"></script>
    
    <!-- Load CMS integration to access admin data -->
    <script src="cms-integration.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .cms-nav { background: #1f2937; }
        .cms-sidebar { background: #111827; }
        .cms-content { background: #f9fafb; }
        .cms-card { background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .cms-input { border: 1px solid #d1d5db; border-radius: 6px; padding: 8px 12px; width: 100%; }
        .cms-btn { padding: 8px 16px; border-radius: 6px; font-weight: 500; cursor: pointer; border: none; }
        .cms-btn-primary { background: #3b82f6; color: white; }
        .cms-btn-primary:hover { background: #2563eb; }
        .cms-btn-secondary { background: #6b7280; color: white; }
        .cms-btn-success { background: #10b981; color: white; }
        .cms-btn-danger { background: #ef4444; color: white; }
        .cms-table { width: 100%; border-collapse: collapse; }
        .cms-table th, .cms-table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }
        .cms-table th { background: #f9fafb; font-weight: 600; }
        .cms-badge { padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500; }
        .cms-badge-live { background: #dcfce7; color: #166534; }
        .cms-badge-draft { background: #fef3c7; color: #92400e; }
        .cms-badge-archived { background: #f3f4f6; color: #6b7280; }
        .logo-preview { max-height: 60px; margin-top: 10px; border: 1px solid #d1d5db; border-radius: 6px; padding: 8px; background: #f9fafb; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="cms-nav text-white p-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <h1 class="text-xl font-bold">Estalara CMS</h1>
                <span class="text-sm text-gray-300">Content Management System</span>
            </div>
            <div class="flex items-center space-x-4">
                <span class="text-sm">Welcome, Admin</span>
                <button class="cms-btn cms-btn-secondary" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <div class="flex">
        <!-- Sidebar -->
        <div class="cms-sidebar text-white w-64 min-h-screen p-4">
            <nav class="space-y-2">
                <a href="#" class="block p-3 rounded hover:bg-gray-700" onclick="showSection('dashboard')">
                    üìä Dashboard
                </a>
                <a href="#" class="block p-3 rounded hover:bg-gray-700" onclick="showSection('live-properties')">
                    üî¥ LIVE Properties
                </a>
                <a href="#" class="block p-3 rounded hover:bg-gray-700" onclick="showSection('page-structure')">
                    üß© Page Structure
                </a>
                <a href="#" class="block p-3 rounded hover:bg-gray-700" onclick="showSection('frontend-editor')">
                    üìù Content
                </a>
                <a href="#" class="block p-3 rounded hover:bg-gray-700" onclick="showSection('media')">
                    üñºÔ∏è Media Library
                </a>
                <a href="#" class="block p-3 rounded hover:bg-gray-700" onclick="showSection('settings')">
                    ‚öôÔ∏è Settings
                </a>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 cms-content p-6">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Dashboard</h2>
                    <p class="text-gray-600">Welcome to Estalara CMS. Manage your content and properties from here.</p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="cms-card p-6">
                        <div class="text-3xl font-bold text-blue-600">24</div>
                        <div class="text-gray-600">Active Properties</div>
                    </div>
                    <div class="cms-card p-6">
                        <div class="text-3xl font-bold text-purple-600">12</div>
                        <div class="text-gray-600">Live Streams</div>
                    </div>
                    <div class="cms-card p-6">
                        <div class="text-3xl font-bold text-orange-600">‚Ç¨2.8M</div>
                        <div class="text-gray-600">Total Value</div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="cms-card p-6">
                    <h3 class="text-lg font-semibold mb-4">Recent Activity</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded">
                            <span class="text-green-600">‚óè</span>
                            <span>New property added: Modern Apartment in Barcelona</span>
                            <span class="text-gray-500 text-sm ml-auto">2 hours ago</span>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded">
                            <span class="text-blue-600">‚óè</span>
                            <span>Live stream started: Luxury Villa Tour</span>
                            <span class="text-gray-500 text-sm ml-auto">4 hours ago</span>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded">
                            <span class="text-purple-600">‚óè</span>
                            <span>New user registered: Maria Rodriguez</span>
                            <span class="text-gray-500 text-sm ml-auto">6 hours ago</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LIVE Properties Section -->
            <div id="live-properties" class="section hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-2">üî¥ LIVE Properties</h2>
                        <p class="text-gray-600">ZarzƒÖdzaj kafelkami nieruchomo≈õci wy≈õwietlanymi na stronie g≈Ç√≥wnej</p>
                    </div>
                    <button class="cms-btn cms-btn-primary" onclick="showLivePropertyModal()">+ Dodaj Kafelek</button>
                </div>

                <!-- Info Card -->
                <div class="cms-card p-6 mb-6 bg-blue-50 border border-blue-200">
                    <h3 class="font-semibold text-blue-900 mb-2">‚ú® Nowy System ZarzƒÖdzania</h3>
                    <p class="text-blue-800 text-sm mb-2">
                        To jest uproszczony system do zarzƒÖdzania kafelkami LIVE Properties na stronie g≈Ç√≥wnej. 
                        Ka≈ºdy kafelek automatycznie otrzymuje czerwony znak "LIVE".
                    </p>
                    <ul class="text-blue-800 text-sm space-y-1">
                        <li>‚Ä¢ <strong>Prostsza edycja</strong> - tylko najwa≈ºniejsze pola (tytu≈Ç, cena, opis, zdjƒôcie)</li>
                        <li>‚Ä¢ <strong>PodglƒÖd na ≈ºywo</strong> - zobacz jak wyglƒÖda kafelek przed zapisaniem</li>
                        <li>‚Ä¢ <strong>≈Åatwe zarzƒÖdzanie</strong> - dodawaj, edytuj i usuwaj kafelki w kilka sekund</li>
                    </ul>
                </div>

                <!-- Properties Grid with Visual Preview -->
                <div id="livePropertiesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Properties will be loaded here as cards -->
                </div>
            </div>

            <!-- Page Structure Section -->
            <div id="page-structure" class="section hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-2">Page Structure Editor</h2>
                        <p class="text-gray-600">Manage sections and blocks for each page - add, delete, hide, or reorder</p>
                    </div>
                </div>

                <!-- Page Selector -->
                <div class="cms-card p-6 mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Select Page to Edit</label>
                    <select id="page-selector" class="cms-input w-full md:w-1/2" onchange="loadPageStructureEditor()">
                        <option value="home">Home</option>
                        <option value="agents">For Agents</option>
                        <option value="agencies">For Agencies</option>
                        <option value="investors">For Investors</option>
                        <option value="about">About</option>
                        <option value="faq">FAQ</option>
                        <option value="privacy">Privacy Policy</option>
                        <option value="terms">Terms of Service</option>
                    </select>
                </div>

                <!-- Structure Visualization -->
                <div class="cms-card p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Page Structure</h3>
                        <button class="cms-btn cms-btn-primary" onclick="showAddSectionModal()">+ Add Section</button>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded mb-4">
                        <p class="text-sm text-gray-600 mb-2">
                            <strong>Visual Guide:</strong>
                        </p>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>‚Ä¢ üëÅÔ∏è Visible section (shown on the page)</li>
                            <li>‚Ä¢ üö´ Hidden section (not displayed on the page)</li>
                            <li>‚Ä¢ üîí Locked section (cannot be deleted)</li>
                            <li>‚Ä¢ Use ‚Üë‚Üì buttons to reorder sections</li>
                        </ul>
                    </div>

                    <div id="sections-list" class="space-y-3">
                        <!-- Sections will be dynamically loaded here -->
                    </div>
                </div>

                <!-- Preview -->
                <div class="cms-card p-6">
                    <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
                    <div class="flex gap-3">
                        <button class="cms-btn cms-btn-success" onclick="previewCurrentPage()">
                            üëÅÔ∏è Preview Page
                        </button>
                        <button class="cms-btn cms-btn-secondary" onclick="resetPageStructure()">
                            üîÑ Reset to Default
                        </button>
                    </div>
                </div>
            </div>

            <!-- Frontend Editor Section -->
            <div id="frontend-editor" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">üé® Frontend Element Editor</h2>
                    <p class="text-gray-600">Edit every single element of your frontend - navigation, buttons, features, footer, and more</p>
                </div>

                <!-- Info Card -->
                <div class="cms-card p-6 mb-6 bg-purple-50 border border-purple-200">
                    <h3 class="font-semibold text-purple-900 mb-2">‚ú® Complete Frontend Control</h3>
                    <p class="text-purple-800 text-sm mb-2">
                        This comprehensive editor allows you to edit every single frontend element without touching code:
                    </p>
                    <ul class="text-purple-800 text-sm space-y-1">
                        <li>‚Ä¢ <strong>Navigation</strong> - Edit menu links, labels, and URLs</li>
                        <li>‚Ä¢ <strong>Hero Sections</strong> - Customize hero text, CTAs, and images for all pages</li>
                        <li>‚Ä¢ <strong>Feature Cards</strong> - Edit icons, titles, descriptions</li>
                        <li>‚Ä¢ <strong>Buttons & CTAs</strong> - Change button text and links</li>
                        <li>‚Ä¢ <strong>Footer</strong> - Update footer text, links, and contact info</li>
                        <li>‚Ä¢ <strong>Global Elements</strong> - Site-wide settings affecting all pages</li>
                    </ul>
                </div>

                <!-- Editor Tabs -->
                <div class="cms-card">
                    <div class="border-b border-gray-200">
                        <nav class="flex -mb-px overflow-x-auto">
                            <button onclick="showFrontendTab('global')" id="tab-global" class="px-6 py-3 border-b-2 border-blue-500 font-medium text-blue-600 whitespace-nowrap">
                                üåç Global
                            </button>
                            <button onclick="showFrontendTab('navigation')" id="tab-navigation" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üß≠ Navigation
                            </button>
                            <button onclick="showFrontendTab('hero')" id="tab-hero" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üéØ Hero
                            </button>
                            <button onclick="showFrontendTab('sections')" id="tab-sections" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üìã Sections
                            </button>
                            <button onclick="showFrontendTab('features')" id="tab-features" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                ‚≠ê Features
                            </button>
                            <button onclick="showFrontendTab('buttons')" id="tab-buttons" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üîò Buttons
                            </button>
                            <button onclick="showFrontendTab('footer')" id="tab-footer" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üë£ Footer
                            </button>
                            <button onclick="showFrontendTab('howitworks')" id="tab-howitworks" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üîÑ How It Works
                            </button>
                            <button onclick="showFrontendTab('agentsfeatures')" id="tab-agentsfeatures" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üëî Agents Features
                            </button>
                            <button onclick="showFrontendTab('aboutcontent')" id="tab-aboutcontent" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üìñ About Content
                            </button>
                            <button onclick="showFrontendTab('statistics')" id="tab-statistics" class="px-6 py-3 border-b-2 border-transparent hover:border-gray-300 font-medium text-gray-600 whitespace-nowrap">
                                üìä Statistics
                            </button>
                        </nav>
                    </div>

                    <!-- Global Elements Tab -->
                    <div id="frontend-global" class="frontend-tab p-6">
                        <h3 class="text-lg font-semibold mb-4">Global Site Elements</h3>
                        <p class="text-sm text-gray-600 mb-6">These settings affect all pages across your website</p>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Title</label>
                                <input type="text" id="global-site-title" class="cms-input" placeholder="Estalara - Go LIVE. Go GLOBAL.">
                                <p class="text-xs text-gray-500 mt-1">Used in browser tab and SEO</p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Description</label>
                                <textarea id="global-site-description" class="cms-input" rows="3" placeholder="Estalara connects real estate agents and international investors..."></textarea>
                                <p class="text-xs text-gray-500 mt-1">Used for SEO and meta descriptions</p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Logo URL</label>
                                <input type="text" id="global-logo-url" class="cms-input" placeholder="assets/EstalaraLogo.png">
                                <p class="text-xs text-gray-500 mt-1">Path to your logo file</p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Contact Email</label>
                                <input type="email" id="global-contact-email" class="cms-input" placeholder="estalara@estalara.com">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Footer Text</label>
                                <input type="text" id="global-footer-text" class="cms-input" placeholder="¬© 2025 Estalara. All rights reserved.">
                            </div>

                            <button onclick="saveFrontendGlobal()" class="cms-btn cms-btn-success">üíæ Save Global Settings</button>
                        </div>
                    </div>

                    <!-- Navigation Tab -->
                    <div id="frontend-navigation" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Navigation Menu</h3>
                        <p class="text-sm text-gray-600 mb-6">Customize the main navigation menu links and labels</p>
                        
                        <div class="space-y-4" id="navigation-items">
                            <!-- Navigation items will be loaded here -->
                        </div>

                        <button onclick="addNavigationItem()" class="cms-btn cms-btn-primary mt-4">+ Add Navigation Link</button>
                        <button onclick="saveFrontendNavigation()" class="cms-btn cms-btn-success mt-4 ml-2">üíæ Save Navigation</button>
                    </div>

                    <!-- Hero Sections Tab -->
                    <div id="frontend-hero" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Hero Sections</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit hero text and CTAs for each page</p>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Select Page</label>
                            <select id="hero-page-selector" class="cms-input w-full md:w-1/2" onchange="loadHeroEditor()">
                                <option value="home">Home</option>
                                <option value="agents">For Agents</option>
                                <option value="agencies">For Agencies</option>
                                <option value="investors">For Investors</option>
                                <option value="about">About</option>
                                <option value="faq">FAQ</option>
                            </select>
                        </div>

                        <div id="hero-editor-content" class="space-y-6">
                            <!-- Hero editor content will be loaded here -->
                        </div>

                        <button onclick="saveFrontendHero()" class="cms-btn cms-btn-success mt-4">üíæ Save Hero Section</button>
                    </div>

                    <!-- Feature Cards Tab -->
                    <div id="frontend-features" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Feature Cards</h3>
                        <p class="text-sm text-gray-600 mb-6">Manage feature cards displayed on your pages</p>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Select Page</label>
                            <select id="features-page-selector" class="cms-input w-full md:w-1/2" onchange="loadFeaturesEditor()">
                                <option value="home">Home</option>
                                <option value="agents">For Agents</option>
                                <option value="agencies">For Agencies</option>
                                <option value="investors">For Investors</option>
                            </select>
                        </div>

                        <div id="features-editor-content" class="space-y-4">
                            <!-- Feature cards will be loaded here -->
                        </div>

                        <button onclick="addFeatureCard()" class="cms-btn cms-btn-primary mt-4">+ Add Feature Card</button>
                        <button onclick="saveFrontendFeatures()" class="cms-btn cms-btn-success mt-4 ml-2">üíæ Save Features</button>
                    </div>

                    <!-- Buttons & CTAs Tab -->
                    <div id="frontend-buttons" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Buttons & Call-to-Actions</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit text and URLs for all buttons and CTAs across your pages</p>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Select Page</label>
                            <select id="buttons-page-selector" class="cms-input w-full md:w-1/2" onchange="loadButtonsEditor()">
                                <option value="global">Global Buttons</option>
                                <option value="home">Home</option>
                                <option value="agents">For Agents</option>
                                <option value="agencies">For Agencies</option>
                                <option value="investors">For Investors</option>
                                <option value="about">About</option>
                            </select>
                        </div>

                        <div id="buttons-editor-content" class="space-y-6">
                            <!-- Primary Button -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Primary Button (Main CTA)</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Button Text</label>
                                        <input type="text" id="primary-button-text" class="cms-input" placeholder="Get Started">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Button URL</label>
                                        <input type="url" id="primary-button-url" class="cms-input" placeholder="https://app.estalara.com">
                                    </div>
                                </div>
                            </div>

                            <!-- Secondary Button -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Secondary Button</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Button Text</label>
                                        <input type="text" id="secondary-button-text" class="cms-input" placeholder="Learn More">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Button URL</label>
                                        <input type="url" id="secondary-button-url" class="cms-input" placeholder="#features">
                                    </div>
                                </div>
                            </div>

                            <!-- Header CTA Button -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Header "Launch App" Button</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Button Text</label>
                                        <input type="text" id="header-cta-text" class="cms-input" placeholder="Launch App">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Button URL</label>
                                        <input type="url" id="header-cta-url" class="cms-input" placeholder="https://app.estalara.com">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button onclick="saveFrontendButtons()" class="cms-btn cms-btn-success mt-4">üíæ Save Buttons</button>
                    </div>

                    <!-- Footer Tab -->
                    <div id="frontend-footer" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Footer Content</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit footer sections, links, and contact information</p>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Footer Company Name</label>
                                <input type="text" id="footer-company-name" class="cms-input" placeholder="Estalara">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Footer Tagline</label>
                                <input type="text" id="footer-tagline" class="cms-input" placeholder="Go LIVE. Go GLOBAL.">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Footer Description</label>
                                <textarea id="footer-description" class="cms-input" rows="3" placeholder="Connecting real estate agents with global investors through AI and livestreaming technology."></textarea>
                            </div>

                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Footer Links</h4>
                                <div id="footer-links-container" class="space-y-3">
                                    <!-- Footer links will be loaded here -->
                                </div>
                                <button onclick="addFooterLink()" class="cms-btn cms-btn-primary mt-3">+ Add Footer Link</button>
                            </div>

                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Social Media Links</h4>
                                <div id="social-links-container" class="space-y-3">
                                    <!-- Social media links will be loaded here -->
                                </div>
                                <button onclick="addSocialLink()" class="cms-btn cms-btn-primary mt-3">+ Add Social Link</button>
                            </div>

                            <button onclick="saveFrontendFooter()" class="cms-btn cms-btn-success">üíæ Save Footer</button>
                        </div>
                    </div>

                    <!-- Section Headings Tab -->
                    <div id="frontend-sections" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Section Headings & Subtitles</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit all section headings and subtitles across all pages</p>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Select Page</label>
                            <select id="sections-page-selector" class="cms-input w-full md:w-1/2" onchange="loadSectionsEditor()">
                                <option value="home">Home</option>
                                <option value="agents">For Agents</option>
                                <option value="agencies">For Agencies</option>
                                <option value="investors">For Investors</option>
                                <option value="about">About</option>
                            </select>
                        </div>

                        <div id="sections-editor-content" class="space-y-6">
                            <!-- Section headings will be loaded here -->
                        </div>

                        <button onclick="saveSectionsContent()" class="cms-btn cms-btn-success mt-4">üíæ Save Section Headings</button>
                    </div>

                    <!-- How It Works Tab -->
                    <div id="frontend-howitworks" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">How It Works Section</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit the steps in the "How It Works" section on the homepage</p>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Section Heading</label>
                                <input type="text" id="hiw-heading" class="cms-input" placeholder="How It Works">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Section Subtitle</label>
                                <textarea id="hiw-subtitle" class="cms-input" rows="2" placeholder="Three simple steps..."></textarea>
                            </div>

                            <div class="border-t pt-4">
                                <h4 class="font-medium text-gray-900 mb-4">Steps</h4>
                                <div id="hiw-steps-container" class="space-y-4">
                                    <!-- Steps will be loaded here -->
                                </div>
                                <button onclick="addHowItWorksStep()" class="cms-btn cms-btn-primary mt-3">+ Add Step</button>
                            </div>

                            <button onclick="saveHowItWorks()" class="cms-btn cms-btn-success">üíæ Save How It Works</button>
                        </div>
                    </div>

                    <!-- Agents Features Tab -->
                    <div id="frontend-agentsfeatures" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Agents Page Features</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit the 6 detailed feature cards on the Agents page (with bullet lists)</p>
                        
                        <div id="agents-features-container" class="space-y-6">
                            <!-- Features will be loaded here -->
                        </div>

                        <button onclick="saveAgentsFeatures()" class="cms-btn cms-btn-success mt-4">üíæ Save Agents Features</button>
                    </div>

                    <!-- About Content Tab -->
                    <div id="frontend-aboutcontent" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">About Page Content</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit paragraph content for Mission, Vision, and What is Estalara sections</p>
                        
                        <div class="space-y-6">
                            <!-- Mission Content -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Mission Statement</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">First Paragraph</label>
                                        <textarea id="mission-p1" class="cms-input" rows="4" placeholder="To democratize global real estate..."></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Second Paragraph</label>
                                        <textarea id="mission-p2" class="cms-input" rows="3" placeholder="Through cutting-edge AI technology..."></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Vision Content -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Vision Statement</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">First Paragraph</label>
                                        <textarea id="vision-p1" class="cms-input" rows="4" placeholder="To become the world's leading platform..."></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Second Paragraph</label>
                                        <textarea id="vision-p2" class="cms-input" rows="3" placeholder="By 2030, we aim to facilitate..."></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- What is Estalara -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">What is Estalara?</h4>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Content</label>
                                    <textarea id="what-is-estalara-content" class="cms-input" rows="6" placeholder="Estalara is the game-changer..."></textarea>
                                    <p class="text-xs text-gray-500 mt-1">Main description paragraph</p>
                                </div>
                            </div>

                            <button onclick="saveAboutContent()" class="cms-btn cms-btn-success">üíæ Save About Content</button>
                        </div>
                    </div>

                    <!-- Statistics Tab -->
                    <div id="frontend-statistics" class="frontend-tab p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Statistics Section</h3>
                        <p class="text-sm text-gray-600 mb-6">Edit the statistics displayed on the Agents page</p>
                        
                        <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg mb-6">
                            <p class="text-sm text-blue-900 mb-2">
                                <strong>üìä Statistics Section:</strong> These numbers appear in the white section on the Agents page, showcasing your platform's key metrics.
                            </p>
                        </div>

                        <div class="space-y-6">
                            <!-- Stat 1 -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Statistic 1</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Number</label>
                                        <input type="text" id="stat1-number" class="cms-input" placeholder="500+">
                                        <p class="text-xs text-gray-500 mt-1">The big number (e.g., 500+, 10K+)</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Label</label>
                                        <input type="text" id="stat1-label" class="cms-input" placeholder="Active Agents">
                                        <p class="text-xs text-gray-500 mt-1">Description below the number</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Stat 2 -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Statistic 2</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Number</label>
                                        <input type="text" id="stat2-number" class="cms-input" placeholder="10K+">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Label</label>
                                        <input type="text" id="stat2-label" class="cms-input" placeholder="Global Investors">
                                    </div>
                                </div>
                            </div>

                            <!-- Stat 3 -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Statistic 3</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Number</label>
                                        <input type="text" id="stat3-number" class="cms-input" placeholder="‚Ç¨2.5B+">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Label</label>
                                        <input type="text" id="stat3-label" class="cms-input" placeholder="Property Value">
                                    </div>
                                </div>
                            </div>

                            <!-- Stat 4 -->
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium text-gray-900 mb-3">Statistic 4</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Number</label>
                                        <input type="text" id="stat4-number" class="cms-input" placeholder="95%">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Label</label>
                                        <input type="text" id="stat4-label" class="cms-input" placeholder="Close Rate">
                                    </div>
                                </div>
                            </div>

                            <button onclick="saveStatistics()" class="cms-btn cms-btn-success">üíæ Save Statistics</button>
                        </div>
                    </div>
                </div>

                <!-- Preview Panel -->
                <div class="cms-card p-6 mt-6">
                    <h3 class="text-lg font-semibold mb-4">Live Preview</h3>
                    <div class="flex gap-3">
                        <button onclick="previewChanges()" class="cms-btn cms-btn-success">
                            üëÅÔ∏è Preview All Changes
                        </button>
                        <button onclick="resetAllFrontend()" class="cms-btn cms-btn-danger">
                            üîÑ Reset to Defaults
                        </button>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div id="media" class="section hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-2">Media Library</h2>
                        <p class="text-gray-600">Manage your images and media files</p>
                    </div>
                    <button class="cms-btn cms-btn-primary" onclick="showUploadModal()">+ Upload Media</button>
                </div>

                <!-- Media Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <div class="cms-card p-3">
                        <img src="https://kimi-web-img.moonshot.cn/img/talatiandpartners.com/952038c4e2cdd1b53bd4fa58a12aa8472e239da8.webp" alt="Property Image" class="w-full h-24 object-cover rounded mb-2">
                        <div class="text-xs text-gray-600 truncate">apartment-interior.jpg</div>
                        <button class="cms-btn cms-btn-danger text-xs w-full mt-2" onclick="deleteMedia(1)">Delete</button>
                    </div>
                    <div class="cms-card p-3">
                        <img src="https://kimi-web-img.moonshot.cn/img/www.valcucine.com/23a9f04943354e7f0279fbe99bcc358000b108f4.jpg" alt="Property Image" class="w-full h-24 object-cover rounded mb-2">
                        <div class="text-xs text-gray-600 truncate">luxury-kitchen.jpg</div>
                        <button class="cms-btn cms-btn-danger text-xs w-full mt-2" onclick="deleteMedia(2)">Delete</button>
                    </div>
                    <div class="cms-card p-3">
                        <img src="https://kimi-web-img.moonshot.cn/img/antonovich-design.com/c4dc761e62d99ae8976671614b35f23c72bda4df.jpg" alt="Property Image" class="w-full h-24 object-cover rounded mb-2">
                        <div class="text-xs text-gray-600 truncate">villa-exterior.jpg</div>
                        <button class="cms-btn cms-btn-danger text-xs w-full mt-2" onclick="deleteMedia(3)">Delete</button>
                    </div>
                </div>
            </div>


            <!-- Settings Section -->
            <div id="settings" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Settings</h2>
                    <p class="text-gray-600">Configure your platform settings</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- General Settings -->
                    <div class="cms-card p-6">
                        <h3 class="text-lg font-semibold mb-4">General Settings</h3>
                        <form id="general-settings-form" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Title</label>
                                <input type="text" id="site-title" name="siteTitle" class="cms-input" value="Estalara - Go LIVE. Go GLOBAL.">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Description</label>
                                <textarea id="site-description" name="siteDescription" class="cms-input" rows="3">Estalara connects real estate agents and international investors through AI and live experiences.</textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Contact Email</label>
                                <input type="email" id="contact-email" name="contactEmail" class="cms-input" value="estalara@estalara.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Upload Logo</label>
                                <div class="space-y-3">
                                    <div class="bg-blue-50 border border-blue-200 p-3 rounded mb-3">
                                        <p class="text-sm text-blue-900 font-semibold mb-1">üõà For Netlify deployment:</p>
                                        <ul class="text-xs text-blue-800 space-y-1">
                                            <li>‚Ä¢ <strong>Recommended:</strong> Use a URL path like <code class="bg-blue-100 px-1 rounded">assets/EstalaraLogo.png</code></li>
                                            <li>‚Ä¢ Make sure the logo file exists in your <code class="bg-blue-100 px-1 rounded">assets/</code> folder</li>
                                            <li>‚Ä¢ File upload creates a data URL (works but increases localStorage size)</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <label for="logo-upload" class="cms-btn cms-btn-primary cursor-pointer inline-block">
                                            üìÅ Choose Logo File
                                        </label>
                                        <input type="file" id="logo-upload" name="logoUpload" accept="image/*" class="hidden">
                                        <p class="text-xs text-gray-500 mt-2">Upload your logo (converts to data URL, stored in browser)</p>
                                    </div>
                                    <div class="text-sm text-gray-600">
                                        <strong>OR</strong> enter a URL:
                                    </div>
                                    <input type="text" id="logo-url" name="logoUrl" class="cms-input" placeholder="assets/EstalaraLogo.png" value="assets/EstalaraLogo.png">
                                    <p class="text-xs text-gray-500">Use a path relative to your website root (e.g., assets/logo.png) or full URL</p>
                                </div>
                                <div id="logo-preview-container" class="mt-4" style="display: none;">
                                    <p class="text-sm font-medium text-gray-700 mb-2">Current Logo:</p>
                                    <img id="logo-preview" class="logo-preview" alt="Logo Preview">
                                </div>
                            </div>
                            <button type="submit" class="cms-btn cms-btn-primary">Save Changes</button>
                        </form>
                    </div>

                    <!-- Platform Settings -->
                    <div class="cms-card p-6">
                        <h3 class="text-lg font-semibold mb-4">Platform Settings</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Default Currency</label>
                                <select id="default-currency" class="cms-input">
                                    <option value="EUR">EUR (‚Ç¨)</option>
                                    <option value="USD">USD ($)</option>
                                    <option value="GBP">GBP (¬£)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Default Language</label>
                                <select id="default-language" class="cms-input">
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Max Upload Size</label>
                                <input type="text" id="max-upload-size" class="cms-input" value="10MB">
                            </div>
                        </div>
                        <button class="cms-btn cms-btn-primary mt-4" onclick="savePlatformSettings()">Save Changes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Section Modal (Page Structure Editor) -->
    <div id="addSectionModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-xl max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Add New Section</h3>
                <button onclick="hideAddSectionModal()" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <form id="addSectionForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Section ID</label>
                    <input type="text" name="sectionId" class="cms-input" placeholder="e.g., custom-features" required>
                    <p class="text-xs text-gray-500 mt-1">Unique identifier (lowercase, no spaces, use hyphens)</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                    <input type="text" name="sectionTitle" class="cms-input" placeholder="e.g., Custom Features" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Section Type</label>
                    <select name="sectionType" class="cms-input">
                        <option value="section">Section</option>
                        <option value="hero">Hero</option>
                        <option value="cta">CTA</option>
                        <option value="stats">Stats</option>
                    </select>
                </div>
                <div class="bg-yellow-50 border border-yellow-200 p-3 rounded">
                    <p class="text-sm text-yellow-800">
                        <strong>Note:</strong> After adding a new section, you'll need to manually add the corresponding HTML to your page file with the matching ID.
                    </p>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="hideAddSectionModal()" class="cms-btn cms-btn-secondary">Cancel</button>
                    <button type="submit" class="cms-btn cms-btn-primary">Add Section</button>
                </div>
            </form>
        </div>
    </div>

    <!-- LIVE Property Modal (New Simplified Version) -->
    <div id="livePropertyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-4xl max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 id="livePropertyModalTitle" class="text-lg font-semibold">üî¥ Dodaj Kafelek LIVE Property</h3>
                <button onclick="hideLivePropertyModal()" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Form Section -->
                <div>
                    <form id="livePropertyForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tytu≈Ç Nieruchomo≈õci *</label>
                            <input type="text" id="live-property-title" name="title" class="cms-input" placeholder="np. Luksusowy Apartament w Barcelonie" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Lokalizacja *</label>
                            <input type="text" id="live-property-location" name="location" class="cms-input" placeholder="np. Barcelona, Hiszpania" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Cena ($) *</label>
                            <input type="number" id="live-property-price" name="price" class="cms-input" placeholder="450000" required>
                        </div>
                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Sypialnie</label>
                                <input type="number" id="live-property-beds" name="beds" class="cms-input" placeholder="3" min="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">≈Åazienki</label>
                                <input type="number" id="live-property-baths" name="baths" class="cms-input" placeholder="2" min="0" step="0.5">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Powierzchnia (m¬≤)</label>
                                <input type="number" id="live-property-area" name="area" class="cms-input" placeholder="120" min="0">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Opis *</label>
                            <textarea id="live-property-description" name="description" class="cms-input" rows="4" placeholder="Kr√≥tki opis nieruchomo≈õci..." required></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">URL Zdjƒôcia *</label>
                            <input type="url" id="live-property-image" name="image" class="cms-input" placeholder="https://example.com/image.jpg" required>
                            <p class="text-xs text-gray-500 mt-1">Wklej link do zdjƒôcia nieruchomo≈õci</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Link do Oferty</label>
                            <input type="url" id="live-property-link" name="link" class="cms-input" placeholder="https://app.estalara.com/listing/..." value="https://app.estalara.com">
                            <p class="text-xs text-gray-500 mt-1">Link do szczeg√≥≈Ç√≥w oferty (opcjonalne)</p>
                        </div>
                        <div class="flex justify-end space-x-3 pt-4">
                            <button type="button" onclick="hideLivePropertyModal()" class="cms-btn cms-btn-secondary">Anuluj</button>
                            <button type="submit" class="cms-btn cms-btn-primary">Zapisz Kafelek</button>
                        </div>
                    </form>
                </div>
                
                <!-- Live Preview Section -->
                <div>
                    <h4 class="text-sm font-medium text-gray-700 mb-3">üëÅÔ∏è PodglƒÖd Kafelka</h4>
                    <div class="bg-gray-50 p-4 rounded-lg border-2 border-gray-200">
                        <div id="livePropertyPreview" class="bg-white p-6 rounded shadow-lg">
                            <div class="mb-4">
                                <img id="preview-image" 
                                     src="https://via.placeholder.com/400x300?text=Dodaj+Zdjƒôcie" 
                                     alt="Preview" 
                                     class="w-full h-48 object-cover mb-4 rounded">
                                <div class="flex justify-between items-start">
                                    <span class="px-3 py-1 bg-red-600 text-white text-xs font-semibold rounded-full">LIVE</span>
                                    <span id="preview-location" class="text-sm text-gray-500">Lokalizacja</span>
                                </div>
                            </div>
                            <h3 id="preview-title" class="text-xl font-bold mb-2 text-black">Tytu≈Ç Nieruchomo≈õci</h3>
                            <p id="preview-description" class="text-gray-600 mb-4 text-sm">Opis nieruchomo≈õci pojawi siƒô tutaj...</p>
                            <div id="preview-details" class="flex gap-4 mb-4 text-sm text-gray-600">
                                <div id="preview-beds-container" class="flex items-center gap-1" style="display: none;">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                    </svg>
                                    <span id="preview-beds">-</span>
                                </div>
                                <div id="preview-baths-container" class="flex items-center gap-1" style="display: none;">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"></path>
                                    </svg>
                                    <span id="preview-baths">-</span>
                                </div>
                                <div id="preview-area-container" class="flex items-center gap-1" style="display: none;">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                                    </svg>
                                    <span id="preview-area">-</span> m¬≤
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span id="preview-price" class="font-bold text-lg text-black">$0</span>
                                <span class="bg-black text-white px-4 py-2 text-sm rounded hover:bg-gray-800 transition-colors">
                                    View Property ‚Üí
                                </span>
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-3 text-center">
                            Tak bƒôdzie wyglƒÖdaƒá kafelek na stronie g≈Ç√≥wnej
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Protection: Redirect to login if not authenticated
        window.addEventListener('DOMContentLoaded', async () => {
            // Check if we were just redirected from login
            const fromLogin = sessionStorage.getItem('redirectingToCms');
            if (fromLogin) {
                sessionStorage.removeItem('redirectingToCms');
                console.log('‚úÖ Redirected from login page successfully');
            }
            
            // Wait for auth service to be ready
            let waitTime = 0;
            const maxWait = 5000;
            while (!window.authService && waitTime < maxWait) {
                await new Promise(resolve => setTimeout(resolve, 100));
                waitTime += 100;
            }
            
            if (!window.authService) {
                console.error('‚ùå Auth service not initialized. Redirecting to login...');
                sessionStorage.setItem('redirectedFromCms', 'true');
                window.location.href = 'cms-login.html';
                return;
            }
            
            // Wait for Firebase to initialize auth state
            const user = await window.authService.waitForAuth();
            if (!user) {
                console.warn('‚ö†Ô∏è Not authenticated. Redirecting to login page...');
                sessionStorage.setItem('redirectedFromCms', 'true');
                window.location.href = 'cms-login.html';
            } else {
                console.log('‚úÖ Authenticated as:', user.email);
            }
        });
        
        // Logout function
        function logout() {
            if (window.authService) {
                window.authService.signOut().then(() => {
                    window.location.href = 'cms-login.html';
                });
            }
        }
    </script>
    <script src="cms.js"></script>
    <script src="quick-sync-button.js"></script>
</body>
</html>
